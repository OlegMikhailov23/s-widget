/**
 * S-Widget - v1.0.0 - 2020-08-28
 * https://github.com/OlegMikhailov23/s-widget
 *
 * Copyright (c) 2020 Oleg Mikhailov
 * Licensed Apache License 2.0 <https://github.com/OlegMikhailov23/s-widget/LICENSE>
 */
"use strict";!function(){!function(t,e,o){var n=2<arguments.length&&void 0!==o?o:"beforeend";t.insertAdjacentHTML(n,e)}(document.querySelector("#widgetContainer"),'<button class="main-button pulse" type="button" id="widgetButton" title="'.concat(widgetProperty.nameOfWidget,'">').concat(widgetProperty.nameOfWidget,'</button>\n<div class="widget-tools">\n  <button class="tool-button tool-button-feedback" type="button" id="feedbackBtn" title="').concat(widgetProperty.nameOfFeedbackBtn,'">').concat(widgetProperty.nameOfFeedbackBtn,'</button>\n  <a class="tool-button tool-button-whatsapp" id="whatsApp" title="').concat(widgetProperty.nameOfWhatsappBtn,'" href="').concat(widgetProperty.refWhatsapp,'">').concat(widgetProperty.nameOfWhatsappBtn,'</a>\n  <a class="tool-button tool-button-vk" id="vk" title="').concat(widgetProperty.nameOfVkBtn,'" href="').concat(widgetProperty.refVk,'">').concat(widgetProperty.nameOfVkBtn,'</a>\n  <a class="tool-button tool-button-inst" id="inst" title="').concat(widgetProperty.nameOfInstBtn,'" href="').concat(widgetProperty.refInst,'">').concat(widgetProperty.nameOfInstBtn,'</a>\n  <a class="tool-button tool-button-recall" id="callMe" title="').concat(widgetProperty.nameOfRecallBtn,'" href="').concat(widgetProperty.refPhoneNumber,'">').concat(widgetProperty.nameOfRecallBtn,'</a>\n</div>\n<div class="modal-bg"></div>\n\n<div class="modal-content" id="popup">\n  <form class="modal__form" id="modalForm">\n    <div class="flex-container">\n      <h3 class="modal__form__title">').concat(widgetProperty.modalFormTitle,'</h3>\n      <input class="modal__form__field modal__form__field-half" type="text" name="modal-name" id="modal-name" value=""\n             placeholder="').concat(widgetProperty.placeHolderName,'" required>\n      <input class="modal__form__field modal__form__field-half" type="tel" name="modal-phone" id="modal-phone"\n             value="" placeholder="').concat(widgetProperty.placeHolderPhone,'" required>\n    </div>\n    <button class="modal__form__submit-btn" type="submit">Submit</button>\n    <div class="load">\n      <img src="img/giphy.gif" alt="Waiting...">\n    </div>\n    <span class="modal__form__usermessage" id="modal-form-usermessage"></span>\n  </form>\n  <button class="modal-content-close" type="button" title="Закрыть" id="formCloseBtn">Закрыть</button>\n</div>'));var t=document.querySelector(".main-button"),e=document.querySelector(".widget-tools"),o=document.querySelector("#feedbackBtn"),n=document.querySelector("#popup"),a=document.querySelector("#formCloseBtn"),r=document.querySelector(".modal-bg");widgetProperty.mainButtonColor&&(t.style.backgroundColor=widgetProperty.mainButtonColor);function c(t){var e,o;return t[e=0,o=t.length,e+Math.floor(Math.random()*(o-e))]}setInterval(function(){t.style.backgroundImage="url('img/".concat(c(backGrounds),"')")},2e3);function l(t){27===t.keyCode&&(d(),s())}function i(t){t.target===r&&(d(),s())}var s=function(){r.classList.remove("modal-bg--show"),t.classList.remove("main-button--close"),e.classList.remove("widget-tools--show"),document.removeEventListener("keydown",l),r.removeEventListener("mouseup",i)},d=function(){n.classList.add("modal-content-hide"),setTimeout(function(){n.classList.remove("modal-content-show"),n.classList.remove("modal-content-hide")},250)};t.addEventListener("click",function(){document.addEventListener("keydown",l),r.addEventListener("mouseup",i),document.querySelector(".widget-tools").classList.toggle("widget-tools--show"),document.querySelector(".modal-bg").classList.toggle("modal-bg--show"),t.classList.toggle("main-button--close")}),o.addEventListener("click",function(){n.classList.add("modal-content-show")}),a.addEventListener("click",function(){d()});var m=document.querySelector(".load"),u=document.querySelector("#modal-form-usermessage");// Send AJAX
$("#modalForm").submit(function(t){t.preventDefault();var e="name="+$("#modal-name").val()+"&phone="+$("#modal-phone").val();//запишем все данные формы в переменную data
$.ajax({url:"".concat(widgetProperty.phpHandler),data:e,type:"post",success:function(){m.style.display="block",setTimeout(function(){m.style.display="none"},800),setTimeout(function(){u.innerText="".concat(widgetProperty.successMessage)},800),setTimeout(function(){u.innerText=" ",n.reset()},8e3)},error:function(){m.style.display="block",setTimeout(function(){m.style.display="none"},800),setTimeout(function(){u.innerText="".concat(widgetProperty.errorMessage)},800),setTimeout(function(){u.innerText=" ",n.reset()},8e3)}})})}();